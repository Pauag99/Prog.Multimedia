import{a as A}from"./chunk-ZWYYQ43X.js";import{Aa as r,Ba as n,Ca as m,Da as b,Ea as d,Fa as x,Ga as w,Ha as k,Ia as h,Ja as C,U as p,V as c,ka as u,la as f,pa as y,ta as g}from"./chunk-IKPA6MXN.js";var S=["gameCanvas"],M=class o{constructor(t){this.soundService=t}gameCanvas;ctx;ship={x:400,y:300,angle:0,radius:15};keys={};asteroids=[];bullets=[];gameOver=!1;gamePaused=!1;animationFrameId=null;puntos=0;asteroidTime=2e3;asteriodInterval;asteroidSpeed=1;ngOnInit(){this.soundService.playSound("asteroid.mp3",.2),this.ctx=this.gameCanvas.nativeElement.getContext("2d"),this.startAsteroidGeneration(),document.addEventListener("visibilitychange",()=>{document.hidden&&this.pausarPartida()})}startAsteroidGeneration(){clearInterval(this.asteriodInterval),this.asteriodInterval=setInterval(()=>this.spawnAsteroid(),this.asteroidTime)}iniciarPartida(){this.resetGame(),this.gameOver=!1,this.gamePaused=!1,this.puntos=0,this.asteroidTime=2e3,this.asteroidSpeed=1,this.update()}pausarPartida(){this.gamePaused=!0,this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),clearInterval(this.asteriodInterval)}resetGame(){this.ship={x:400,y:300,angle:0,radius:15},this.asteroids=[],this.bullets=[],this.spawnAsteroids(),this.startAsteroidGeneration()}spawnAsteroids(){for(let t=0;t<5;t++)this.asteroids.push(new l(Math.random()*500,Math.random()*500,30,this.asteroidSpeed,Math.random()*Math.PI*2))}spawnAsteroid(){this.asteroids.push(new l(Math.random()*500,Math.random()*500,30,this.asteroidSpeed,Math.random()*Math.PI*2))}keyDown(t){["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)&&t.preventDefault(),this.keys[t.key]=!0,t.key===" "&&(this.shoot(),t.preventDefault())}keyUp(t){this.keys[t.key]=!1}shoot(){this.bullets.push(new v(this.ship.x,this.ship.y,this.ship.angle))}update(){this.gameOver||this.gamePaused||(this.clearCanvas(),this.updateShip(),this.updateAsteroids(),this.updateBullets(),this.checkCollisions(),this.drawShip(),this.drawAsteroids(),this.drawBullets(),this.animationFrameId=requestAnimationFrame(()=>this.update()))}clearCanvas(){this.ctx.clearRect(0,0,this.gameCanvas.nativeElement.width,this.gameCanvas.nativeElement.height)}updateShip(){this.keys.ArrowUp&&(this.ship.x+=Math.cos(this.ship.angle)*2,this.ship.y+=Math.sin(this.ship.angle)*2),this.keys.ArrowDown&&(this.ship.x-=Math.cos(this.ship.angle)*2,this.ship.y-=Math.sin(this.ship.angle)*2),this.keys.ArrowLeft&&(this.ship.angle-=.05),this.keys.ArrowRight&&(this.ship.angle+=.05),this.ship.x<0&&(this.ship.x=500),this.ship.x>500&&(this.ship.x=0),this.ship.y<0&&(this.ship.y=500),this.ship.y>500&&(this.ship.y=0)}updateAsteroids(){for(let t of this.asteroids)t.update()}updateBullets(){for(let t of this.bullets)t.update()}checkCollisions(){for(let t=this.bullets.length-1;t>=0;t--)for(let e=this.asteroids.length-1;e>=0;e--){let i=this.bullets[t].x-this.asteroids[e].x,s=this.bullets[t].y-this.asteroids[e].y;if(Math.sqrt(i*i+s*s)<this.asteroids[e].radius){this.bullets.splice(t,1),this.asteroids.splice(e,1),this.puntos+=10,this.puntos%50==0&&this.asteroidTime>500&&(this.asteroidTime-=250,this.startAsteroidGeneration()),this.puntos%100==0&&(this.asteroidSpeed+=1);break}}for(let t of this.asteroids){let e=this.ship.x-t.x,i=this.ship.y-t.y;if(Math.sqrt(e*e+i*i)<t.radius+this.ship.radius){this.gameOver=!0,alert("Game Over"),this.resetGame();break}}}drawShip(){this.ctx.save(),this.ctx.translate(this.ship.x,this.ship.y),this.ctx.rotate(this.ship.angle),this.ctx.beginPath(),this.ctx.moveTo(15,0),this.ctx.lineTo(-15,10),this.ctx.lineTo(-15,-10),this.ctx.closePath(),this.ctx.strokeStyle="black",this.ctx.stroke(),this.ctx.restore()}drawAsteroids(){for(let t of this.asteroids)t.draw(this.ctx)}drawBullets(){for(let t of this.bullets)t.draw(this.ctx)}static \u0275fac=function(e){return new(e||o)(y(A))};static \u0275cmp=g({type:o,selectors:[["app-arcade-list"]],viewQuery:function(e,i){if(e&1&&x(S,7),e&2){let s;w(s=k())&&(i.gameCanvas=s.first)}},hostBindings:function(e,i){e&1&&d("keydown",function(a){return i.keyDown(a)},!1,u)("keyup",function(a){return i.keyUp(a)},!1,u)},decls:11,vars:1,consts:[["gameCanvas",""],[3,"click"],["width","500","height","500"]],template:function(e,i){if(e&1){let s=b();r(0,"h2"),h(1,"ARCADE"),n(),r(2,"button",1),d("click",function(){return p(s),c(i.iniciarPartida())}),h(3,"Iniciar"),n(),r(4,"button",1),d("click",function(){return p(s),c(i.pausarPartida())}),h(5,"Parar"),n(),m(6,"br"),r(7,"b"),h(8),n(),m(9,"canvas",2,0)}e&2&&(f(8),C("Puntuaci\xF3n: ",i.puntos,""))},styles:["canvas[_ngcontent-%COMP%]{border:1px solid black;display:block;margin:0 auto 20px;width:500px;height:500px}"]})},l=class{constructor(t,e,i,s,a,I="black"){this.x=t;this.y=e;this.radius=i;this.speed=s;this.angle=a;this.color=I}update(){this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.x<0&&(this.x=500),this.x>500&&(this.x=0),this.y<0&&(this.y=500),this.y>500&&(this.y=0)}draw(t){t.beginPath(),t.arc(this.x,this.y,this.radius,0,Math.PI*2),t.strokeStyle=this.color,t.stroke()}},v=class{constructor(t,e,i){this.x=t;this.y=e;this.angle=i}update(){this.x+=Math.cos(this.angle)*5,this.y+=Math.sin(this.angle)*5}draw(t){t.beginPath(),t.arc(this.x,this.y,2,0,Math.PI*2),t.fill()}};export{M as ArcadeListComponent};
